<!DOCTYPE html>
<html lang="fr" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KARIM13 | PANEL</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
    <style>
        :root { --bg: #0b111b; --card: #161c26; --accent: #10b981; --gold: #f59e0b; --text: #ffffff; }
        body { background: var(--bg); color: var(--text); font-family: sans-serif; text-align: center; margin: 0; }
        .card { background: var(--card); margin: 15px; padding: 20px; border-radius: 20px; border: 1px solid #2d3748; }
        .btn { width: 100%; padding: 15px; border-radius: 10px; border: none; font-weight: bold; cursor: pointer; margin-top: 10px; }
        .history-item { background: #0b111b; padding: 15px; border-radius: 10px; margin-bottom: 10px; text-align: left; position: relative; border: 1px solid #2d3748; }
        .status { position: absolute; right: 10px; top: 10px; background: var(--gold); color: black; padding: 2px 8px; border-radius: 5px; font-size: 12px; }
        /* Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙˆØ§Ø¶Ø­Ø© */
        #adminView { display: none; padding: 20px; background: #000; min-height: 100vh; }
        .admin-card { background: #1a1a1a; padding: 15px; border-radius: 15px; margin-bottom: 15px; border-left: 5px solid var(--accent); text-align: left; }
        .controls { display: flex; gap: 10px; margin-top: 10px; }
        .btn-ok { background: var(--accent); color: white; flex: 1; padding: 10px; border-radius: 5px; border: none; }
        .btn-del { background: #ef4444; color: white; flex: 1; padding: 10px; border-radius: 5px; border: none; }
        #openAdminBtn { opacity: 0.1; background: none; color: gray; border: none; margin-top: 50px; }
    </style>
</head>
<body>

<div id="userView">
    <h2 style="margin-top:20px;">KARIM<span>13</span> ğŸ¬</h2>
    <div class="card">
        <input type="text" id="link" placeholder="Lien / URL" style="width:90%; padding:10px; margin-bottom:10px;">
        <button class="btn" style="background:var(--accent); color:white;" onclick="send()">Commander</button>
        <button class="btn" style="background:var(--gold);" onclick="showHistory()">Historique</button>
    </div>
    <button id="openAdminBtn" onclick="activateAdmin()">Admin Space</button>
</div>

<div id="adminView">
    <h2 style="color:var(--gold);">ğŸ¬ Ø¥Ø¯Ø§Ø±Ø© Ø·Ù„Ø¨Ø§Øª ÙƒØ±ÙŠÙ…</h2>
    <button onclick="location.reload()" style="background:gray; color:white; border:none; padding:10px; border-radius:5px; margin-bottom:20px;">Ø®Ø±ÙˆØ¬</button>
    <div id="adminOrders"></div>
</div>

<script>
    const firebaseConfig = {
      apiKey: "AIzaSyBAGmBZN-aa6ywe3dPYFVABPMJQPzgZxP0",
      authDomain: "karim-smm.firebaseapp.com",
      projectId: "karim-smm",
      storageBucket: "karim-smm.firebasestorage.app",
      messagingSenderId: "968826000164",
      appId: "1:968826000164:web:aa41869e201784b85c59b1"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    function send() {
        const link = document.getElementById('link').value;
        if(!link) return alert("Link?");
        db.collection("orders").add({
            link: link, status: "Pending", date: new Date().toLocaleString(), uid: 'user1'
        }).then(() => alert("OK!"));
    }

    function activateAdmin() {
        const pass = prompt("Password?");
        if(pass === "1313") {
            document.getElementById('userView').style.display = 'none';
            document.getElementById('adminView').style.display = 'block';
            loadOrders();
        }
    }

    function loadOrders() {
        db.collection("orders").orderBy("date", "desc").onSnapshot(snap => {
            let html = "";
            snap.forEach(doc => {
                const d = doc.data();
                html += `
                <div class="admin-card">
                    <span style="color:var(--gold)">Status: ${d.status}</span><br>
                    <small>${d.date}</small><br>
                    <b>Link: ${d.link}</b>
                    <div class="controls">
                        <button class="btn-ok" onclick="update('${doc.id}', 'Completed')">Ù…ÙƒØªÙ…Ù„ âœ…</button>
                        <button class="btn-del" onclick="del('${doc.id}')">Ø­Ø°Ù ğŸ—‘ï¸</button>
                    </div>
                </div>`;
            });
            document.getElementById('adminOrders').innerHTML = html;
        });
    }

    function update(id, s) { db.collection("orders").doc(id).update({status: s}); }
    function del(id) { if(confirm("Ø­Ø°ÙØŸ")) db.collection("orders").doc(id).delete(); }
</script>
</body>
</html>
